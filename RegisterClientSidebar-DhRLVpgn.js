import{a6 as W,a7 as Y,d as R,e4 as H,k as S,dM as q,ap as Q,o as l,c as k,p as m,b as e,e5 as X,n as $,h as V,t as w,j as d,g as s,a as r,e6 as ee,f as c,e7 as te,dk as ae,e8 as se,e9 as le,ea as ie,q as oe,eb as re,c1 as ne,F as P,ax as ue,ec as de,_ as T,w as ce,x as pe,s as U,ar as me,m as fe,dJ as ge,ed as ve,cq as ye,ah as D,ai as J,az as be,am as _e,cs as he,cu as xe,bq as Ce,bZ as I,ee as ke,ac as G,aw as we,C as Se,D as $e}from"./index-B-Wkf0n4.js";import{g as Ve}from"./index-D4WyjqXo.js";import{_ as Ae}from"./AppCard.vue_vue_type_script_setup_true_lang-Ydeva4hB.js";import{A as Ne}from"./AppAvatar-BdJv6vRT.js";import{r as Be}from"./PencilIcon-D8YgaM7j.js";import{r as Ie,I as qe}from"./ImageCropper-CWWzgOK_.js";import{A as Ee}from"./AppRadioButton-DpuArxZO.js";import{S as Oe,_ as ze}from"./SheetContent-BOWKuCjY.js";import{_ as Le,a as Ge}from"./SheetFooter.vue_vue_type_script_setup_true_lang-L3yIWRCc.js";import{v as Re}from"./RegisterClientSidebar.vue_vue_type_style_index_0_scoped_61ef26e9_lang-B0nnXGfK.js";import{_ as Te}from"./RegisterEmailDomainPart.vue_vue_type_script_setup_true_lang-D-GVFW2p.js";import"./DialogContent.vue_vue_type_script_setup_true_lang-BWKHsfd4.js";/* empty css                                                                     */import"./vee-validate-zod.esm--Fzx1q_g.js";import"./TooltipProvider.vue_vue_type_script_setup_true_lang-DecDKEiB.js";const je={create:"/policy_holders"},Fe=W((a,h)=>(h||(h="test"),Y.post(`/${h}${je.create}`,a))),Me={class:"relative mt-1"},Ue={key:0,class:"mr-auto ml-1 text-sm text-secondary/70"},De={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize bg-primary/10 text-primary-light hover:bg-primary/20"},Je=["src"],Pe={key:1,class:"text__error"},Ke=R({__name:"AppSelect",props:{options:{type:[Array,Array],required:!0},initialValue:{type:[Object,String,Array,Boolean],required:!1},optionLabel:{type:String,default:"label"},optionValue:{type:String,default:"value"},size:{type:String,default:"md"},label:{type:[String,Boolean],default:"label"},labelInside:{type:[String,Boolean],default:!1},chipCount:{type:[Number,Boolean],default:!1},message:{type:String,required:!1},name:{type:String,required:!0},rules:{type:Object,required:!1},search:{type:Boolean,defaut:!1},loading:{type:Boolean,defaut:!1},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},debounce:{type:Boolean,default:!1},translate:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},filterOptions:{type:Boolean,default:!0}},emits:["input"],setup(a,{emit:h}){const u=a,{locale:x}=H(),b=h,y=S(""),{errorMessage:f,value:i,setValue:g}=q(u.name,u.rules,{initialValue:""});u.initialValue&&g(u.initialValue);const v=Q(()=>y.value===""?u.options:u.options.filter(C=>u.filterOptions?C[u.optionLabel].toLowerCase().normalize("NFD").replace(/[^a-zA-Z\s]/g,"").includes(y.value.toLowerCase().normalize("NFD").replace(/[^a-zA-Z\s]/g,"")):C[u.optionLabel]));let N;const O=C=>{const _=C.target===document?C.target.documentElement:C.target;y.value!==_.value&&(y.value=_.value,_&&(u.debounce?(clearTimeout(N),N=setTimeout(()=>{b("input",_.value)},400)):b("input",_.value)))};return(C,_)=>(l(),k(e(de),{as:"div",name:a.name,modelValue:e(i),"onUpdate:modelValue":_[0]||(_[0]=p=>ue(i)?i.value=p:null),multiple:a.multiple},{default:m(()=>[a.label?(l(),k(e(X),{key:0,class:$(["label block text-sm font-medium text-gray-700",[a.required&&"required"]])},{default:m(()=>[V(w(a.label),1)]),_:1},8,["class"])):d("",!0),s("div",Me,[r(e(ee),{id:a.name,class:$(["combobox__input",[a.size==="md"&&"!py-[14.5px]",a.size==="sm"&&"!py-[9px]",e(f)&&"combobox__input_danger",{"pl-10":a.search,invalid:e(f)}]]),readonly:!a.search,disabled:a.disabled,autocomplete:"off",onChange:O,"display-value":p=>typeof p=="string"?e(x)(p,"api",a.translate):e(x)(p[u.optionLabel],"api",a.translate)},null,8,["id","readonly","disabled","class","display-value"]),r(e(le),{class:"absolute w-full inset-y-0 left-0 cursor-default right-0 flex items-center justify-end rounded-r-md px-2 focus:outline-none",disabled:a.disabled},{default:m(()=>[a.labelInside?(l(),c("span",Ue,w(a.labelInside),1)):d("",!0),a.chipCount?(l(),c("span",De,w(a.chipCount),1)):d("",!0),a.search&&!a.loading?(l(),k(e(te),{key:2,class:"h-5 absolute left-0 ml-3 text-gray-500"})):d("",!0),a.loading?(l(),k(e(ae),{key:3,class:"h-5 absolute left-0 ml-3 text-gray-500"})):d("",!0),r(e(se),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),_:1},8,["disabled"]),v.value.length>0?(l(),k(e(ie),{key:0,class:"combobox__options"},{default:m(()=>[(l(!0),c(P,null,oe(v.value,(p,z)=>(l(),k(e(re),{key:z,value:p,as:"template"},{default:m(({active:A,selected:B})=>[s("li",{class:$(["relative cursor-default select-none py-2 pl-3 pr-9 text-sm",A?"bg-primary text-white":"text-gray-900"])},[s("span",{class:$(["block truncate",B&&"font-semibold"])},[typeof p=="object"&&p.image?(l(),c("img",{key:0,src:typeof p=="object"?p.image:"",class:"h-8 w-8 inline-block mx-3 bg-white rounded-full"},null,8,Je)):d("",!0),V(" "+w(typeof p=="string"?e(x)(p,"api",a.translate):p[a.optionLabel]),1)],2),B?(l(),c("span",{key:0,class:$(["absolute inset-y-0 right-0 flex items-center pr-4",A?"text-white":"text-primary"])},[r(e(ne),{class:"h-5 w-5","aria-hidden":"true"})],2)):d("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):d("",!0)]),e(f)?(l(),c("p",Pe,w(e(f)),1)):d("",!0)]),_:1},8,["name","modelValue","multiple"]))}}),Ze=T(Ke,[["__scopeId","data-v-5eafa6ab"]]),We=["for","textContent"],Ye=["disabled"],He={key:0,class:"h-[80px] !w-[80px] bg-gray-300/70 rounded-full flex items-center justify-center"},Qe=["src"],Xe={key:0,class:"text__error"},et=R({__name:"AppAvatarUploader",props:{name:{},label:{},required:{type:Boolean},disabled:{type:Boolean,default:!1}},setup(a){const h=a,{setValue:u}=q(h.name),{errorMessage:x}=q(`${h.name}.file_data`),b=S(!1),y=S(),f=i=>{y.value=i,u({...i,file_data:i.file_data.split(",")[1]})};return(i,g)=>(l(),c("div",null,[ce(s("label",{for:i.name,class:$(["block text-sm font-medium text-gray-700 mb-2",[i.required&&"required"]]),textContent:w(i.label)},null,10,We),[[pe,i.label]]),(l(),c("button",{class:"relative w-[80px] group/image",disabled:i.disabled,key:"img-cropper",type:"button",onClick:g[1]||(g[1]=U(v=>b.value=!b.value,["stop"]))},[y.value?(l(),c("img",{key:1,src:y.value.file_data,class:"rounded-full shadow"},null,8,Qe)):(l(),c("div",He,[r(e(Ie),{class:"h-10 w-10 text-white"})])),i.disabled?d("",!0):(l(),c("button",{key:2,onClick:g[0]||(g[0]=U(v=>b.value=!b.value,["stop"])),type:"button",class:"border rounded-full absolute bottom-0 right-1 p-1 bg-white group-hover/image:scale-110 transition-transform duration-150"},[r(e(Be),{class:"h-4 w-4"})]))],8,Ye)),r(e(qe),{active:b.value,"onUpdate:active":g[2]||(g[2]=v=>b.value=v),onUpdateImage:f},null,8,["active"]),e(x)?(l(),c("p",Xe,w(e(x)),1)):d("",!0)]))}}),tt=T(et,[["__scopeId","data-v-792ca7a2"]]),E=a=>(Se("data-v-61ef26e9"),a=a(),$e(),a),at={class:"h-screen max-h-full relative overflow"},st=E(()=>s("div",{class:"bg-primary/5 min-h-[100px] flex items-center px-5 text-lg"},[s("p",{class:"text-gray-700 tracking-wide text-[22px] font-thin"},[V(" Cadastrar "),s("span",{class:"font-normal"},"tomador")])],-1)),lt={class:"relative flex-1 overflow-y-auto"},it={class:"relative flex-1 px-4 sm:px-6 py-8"},ot={class:"grid grid-cols-1 gap-6",key:"is_group"},rt={class:"grid grid-cols-1 gap-6 item-drop-list",key:"group"},nt={key:"is_group-2"},ut=E(()=>s("p",{class:"text-sm font-medium text-gray-700"}," Este tomador será incluído no grupo econômico: ",-1)),dt={class:"flex items-center gap-4"},ct=E(()=>s("div",{class:"w-full py-4",key:"divider-1"},[s("hr")],-1)),pt={class:"grid grid-cols-1 gap-6 item-drop-list",key:"cnpj"},mt={class:"grid grid-cols-1 gap-6 item-drop-list",key:"corporate_name"},ft={class:"grid grid-cols-1 gap-6 item-drop-list",key:"fantasy_name"},gt={class:"grid grid-cols-1 gap-6 item-drop-list",key:"email_do_contato"},vt=E(()=>s("div",{class:"w-full py-4",key:"domain"},[s("hr")],-1)),yt={class:"text-danger text-sm"},bt={class:"flex w-full justify-end space-x-3 border-t border-default px-3 py-4 bg-base-200/60"},_t={class:"w-full flex items-center justify-center gap-3"},ht=R({__name:"RegisterClientSidebar",props:{isRegistering:{type:Boolean},registerGroupOption:{type:Boolean,default:!0},client:{}},emits:["update:is-registering","registered"],setup(a,{emit:h}){const u=a,x=h,b=me(),y=fe(),f=S(),i=S({id:!0,title:"Sim"}),g=S(!1),v=S({error:!1,message:[]});u.registerGroupOption?y.getAllClients.length===0&&y.fetchClients():f.value=u.client||void 0;const{handleSubmit:N,setErrors:O,setValues:C,setFieldValue:_}=ge({validationSchema:Re(i)}),{setValue:p,errorMessage:z}=q("data.domains",{initialValue:[]}),A=N(async o=>{g.value=!0;const t={...o.data,name:o.data.company_attributes.corporate_name};i.value.id?await K(t):await B(t),g.value=!1}),B=async o=>{const t=await ve(o);return t.ok?j(t.value):F(t.error)},K=async o=>{const t=await Fe(o,f.value?.id);return t.ok?j(t.value):F(t.error)},j=async o=>{await y.fetchClients(),ye({title:"",message:i.value.id?"Tomador cadastrado com sucesso":"Grupo cadastrado com sucesso",type:"success"}),D(J.CLICK_REGISTER_NEW_COMPANY,{origin:u.registerGroupOption?"select_client":"client_config",type:i.value.id?"policyholder":"client"}),i.value.id||b.push({name:be.BROKER_CLIENT_ONBOARDING,params:{slug:o.slug}}),x("registered"),x("update:is-registering",!1)},F=o=>{const t=o.response?.data;if(t)for(const n in t.data)v.value.message.push(t.data[n]);v.value.error=!0};_e(()=>{u.registerGroupOption||C({group:f.value}),setTimeout(()=>{O({})},200)});const M=S();async function Z(o){if(o.length>=18&&M.value!==o){const t=o.replace(/\./g,"").replace("-","").replace("/","");M.value=o;const n=await Ve(t);n.ok&&(n.value.razao_social&&_("data.company_attributes.corporate_name",n.value.razao_social),n.value.estabelecimento.nome_fantasia&&_("data.company_attributes.fantasy_name",n.value.estabelecimento.nome_fantasia||""))}}const L=()=>{x("update:is-registering",!1)};return(o,t)=>(l(),k(e(ze),{open:o.isRegistering},{default:m(()=>[r(e(Oe),{onClickClose:t[7]||(t[7]=n=>L()),onInteractOutside:t[8]||(t[8]=n=>L()),onEscapeKeyDown:t[9]||(t[9]=n=>L()),class:"p-0 w-full sm:w-[450px]"},{default:m(()=>[r(e(he),{asChild:""},{default:m(()=>[r(e(xe),null,{default:m(()=>[V("Cadastrar tomador ")]),_:1})]),_:1}),s("div",at,[s("form",{onSubmit:t[4]||(t[4]=(...n)=>e(A)&&e(A)(...n)),class:"flex h-full flex-col divide-y divide-gray-200/75 bg-white overflow-y-auto"},[st,s("div",lt,[s("div",it,[s("div",null,[r(Ce,{tag:"ul",name:"drop-list",class:"space-y-4 relative"},{default:m(()=>[o.registerGroupOption?(l(),c("div",ot,[r(e(Ee),{label:"Esse novo tomador pertence a um grupo econômico cadastrado?",name:"is_group",required:"",selected:i.value,"onUpdate:selected":t[0]||(t[0]=n=>i.value=n),options:[{id:!0,title:"Sim"},{id:!1,title:"Não"}]},null,8,["selected"])])):d("",!0),o.registerGroupOption?(l(),c("div",rt,[i.value.id?(l(),k(e(Ze),{key:0,search:"",name:"group",label:"Grupo econômico",optionValue:"id",optionLabel:"name",options:e(y).getAllClients||[],initialValue:f.value&&{...f.value},modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=n=>f.value=n),required:!0,size:"sm"},null,8,["options","initialValue","modelValue"])):d("",!0)])):d("",!0),o.registerGroupOption?d("",!0):(l(),c("div",nt,[ut,r(e(Ae),{class:"p-2 mt-2 !rounded-lg",responsive:!1},{default:m(()=>[s("div",null,[s("div",dt,[r(e(Ne),{src:o.client?.image,name:o.client?.name,size:"md"},null,8,["src","name"]),s("p",null,w(o.client?.name),1)])])]),_:1})])),ct,s("div",pt,[r(e(I),{name:"data.company_attributes.cnpj",onInput:Z,mask:e(ke),label:"CNPJ",size:"sm",inputType:"text",required:""},null,8,["mask"])]),s("div",mt,[r(e(I),{name:"data.company_attributes.corporate_name",label:"Razão social",size:"sm",inputType:"text",required:""})]),s("div",ft,[r(e(I),{name:"data.company_attributes.fantasy_name",label:"Nome fantasia",size:"sm",inputType:"text",required:""})]),o.registerGroupOption?(l(),c("div",gt,[i.value.id?d("",!0):(l(),k(e(I),{key:0,name:"data.operational_email",label:"Email operacional",size:"sm",inputType:"text",required:""}))])):d("",!0),r(e(tt),{name:"data.image",label:"Logo da empresa",key:"avatar-upload"}),i.value.id?d("",!0):(l(),c(P,{key:4},[vt,r(Te,{onUpdate:t[2]||(t[2]=n=>e(p)(n))}),s("div",yt,w(e(z)?"Campo obrigatório":""),1)],64))]),_:1})])])]),s("div",bt,[r(e(G),{variant:"white",type:"button",disabled:g.value,class:$(g.value&&"opacity-60"),onClick:t[3]||(t[3]=n=>(o.$emit("update:is-registering",!1),e(D)(e(J).CLICK_CANCEL_NEW_COMPANY,{origin:u.registerGroupOption?"select_client":"client_config"})))},{default:m(()=>[V(" Cancelar ")]),_:1},8,["disabled","class"]),r(e(G),{loading:g.value,type:"submit"},{default:m(()=>[V("Salvar")]),_:1},8,["loading"])])],32),r(e(we),{modelValue:v.value.error,"onUpdate:modelValue":t[6]||(t[6]=n=>v.value.error=n),type:"danger",text:v.value.message.join(" ")},{default:m(()=>[s("div",_t,[r(e(G),{label:"Voltar",class:"w-[150px]",onClick:t[5]||(t[5]=()=>{v.value.message.splice(0),v.value.error=!1})})])]),_:1},8,["modelValue","text"])]),r(e(Le),null,{default:m(()=>[r(e(Ge),{"as-child":""},{default:m(()=>[V("close ")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}}),Lt=T(ht,[["__scopeId","data-v-61ef26e9"]]);export{Lt as default};
